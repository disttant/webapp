<!-- Model Form -->
<div class="d-flex flex-column w-100 border h-100 alert alert-light" role="alert" >

    <div class="d-flex flex-column">
        <div class="p-2">
            <div id="modelType" class="font-weight-bold text-capitalize">{{modelType}}</div>
            <div id="modelName" class="small">{{modelName}}</div>
        </div>
        <div id="modelDescription" class="p-2 text-capitalize">
            {{modelDescription}}
        </div>
    </div>



    <div>
        <hr />
    </div>

    <div class="d-flex justify-content-between p-2 py-4">
        <div class="my-auto">
            <i class="material-icons md-36">power_settings_new</i>
        </div>
        <div class="my-auto">
            <label class="switch">
                <input type="checkbox" id="powerSwitch">
                <span class="slider round"></span>
            </label>
        </div>
    </div>

    <div class="d-flex justify-content-between p-2 py-4">
        <div class="my-auto">
            <i class="material-icons md-36">brightness_high</i>
        </div>
        <div class="my-auto">
            <div id="brightnessSquare" class="border mb-4 rounded p-3"></div>
            <input type="range" id="brightnessRange" min="0" max="255" step="1" >
        </div>
    </div>
    
    <div class="d-flex justify-content-between p-2 pt-4 mb-4">
        <div class="my-auto">
            <i class="material-icons md-36">color_lens</i>
        </div>
        <div class="my-auto">
            <div id="colorSquare" class="border mb-4 rounded p-3"></div>
            <input type="range" id="colorRange" min="0" max="255" step="1" >
        </div>
    </div>



    <div>
        <hr />
    </div>
    
    <div class="d-flex justify-content-between p-2 pt-4">
        <div class="my-auto">
            Presence
            <div class="d-block text-muted small">Routine</div>
        </div>
        <div class="my-auto">
            <label class="switch">
                <input type="checkbox" id="presenceSwitch">
                <span class="slider round"></span>
            </label>
        </div>
    </div>

    <div class="d-flex justify-content-between p-2 pt-4">
        <div class="my-auto">
            Nightmares
            <div class="d-block text-muted small">Routine</div>
        </div>
        <div class="my-auto">
            <label class="switch">
                <input type="checkbox" id="nightmaresSwitch">
                <span class="slider round"></span>
            </label>
        </div>
    </div>

    <div class="d-flex justify-content-between p-2 pt-4">
        <div class="my-auto">
            Party
            <div class="d-block text-muted small">Routine</div>
        </div>
        <div class="my-auto">
            <label class="switch">
                <input type="checkbox" id="partySwitch">
                <span class="slider round"></span>
            </label>
        </div>
    </div>

</div>





<!-- Module Logic -->
<script>
$(function() {

    /*
     *
     * FUTURE MESSAGE DEFINITION
     * 
     */
    let order = {
        power : true,
        brightness : {
            step : 130,
        },
        color: {
            step: 80,
        },
        routines : {
            presence    : false,
            nightmares  : false,
            party       : false,

        }
    }


    /*
     *
     * SETTING FUNCTION DEFINITIONS
     * 
     */

    function setPower( state ){

        // Setting the state of power switch
        $('#powerSwitch').attr('checked', state);

        // Changing the cache var
        order.power = state;
    }



    function setBrightness( step ){

        // Calculate the RGB Value from HSL
        let brightness = color.hslToRgb( 0.155, 1, step/255);

        brightness[0] = Math.round(brightness[0]);
        brightness[1] = Math.round(brightness[1]);
        brightness[2] = Math.round(brightness[2]);

        // Setting the brightness square color
        $('#brightnessSquare').css('background-color', 'rgb('+brightness[0]+','+brightness[1]+','+brightness[2]+')');

        // Resetting the slider
        $('#brightnessRange').val(step);
        //brightnessSquare

        // Changing the cache var
        order.brightness.step = step;
    }



    function setColor( step ){

        // Calculate the RGB Value from HSL
        let colorRGB = color.hslToRgb( step/255, 0.8, 0.8);

        colorRGB[0] = Math.round(colorRGB[0]);
        colorRGB[1] = Math.round(colorRGB[1]);
        colorRGB[2] = Math.round(colorRGB[2]);

        // Setting the square color
        $('#colorSquare').css('background-color', 'rgb('+colorRGB[0]+','+colorRGB[1]+','+colorRGB[2]+')');

        // Resetting the slider
        $('#colorRange').val(step);

        // Changing the cache var
        order.color.step = step;
    }


    function setOffRoutines( ){

    }



    function setPresence( state ){

        // Setting the state of power switch
        $('#presenceSwitch').attr('checked', state);

        // Changing the cache var
        order.routines.presence = state;
    }



    function setNightmares( state ){

        // Setting the state of power switch
        $('#nightmaresSwitch').attr('checked', state);

        // Changing the cache var
        order.routines.nightmares = state;
    }



    function setParty( state ){

        // Setting the state of power switch
        $('#partySwitch').attr('checked', state);

        // Changing the cache var
        order.routines.party = state;
    }
    


    /*
     *
     * SETTING INITIAL VALUES
     * 
     */
    setPower( order.power );
    setBrightness( order.brightness.step );
    setColor( order.color.step );
    setPresence( order.routines.presence );
    setNightmares( order.routines.nightmares );
    setParty( order.routines.party );



    /*
     *
     * DETECTING COMPONENTS
     * 
     */

    // Clean some events
    $('body').off();

    // Detecting power change
    $('body').on('change', '#powerSwitch', function(){
        
        setPower( $(this).attr('checked') );

    });

    // Detecting color change
    $('body').on('input', '#brightnessRange', function(){
        
        setBrightness( $(this).val() );

    });

    // Detecting color change
    $('body').on('input', '#colorRange', function(){
        
        setColor( $(this).val() );

    });

    // Detecting presence routine
    $('body').on('input', '#presenceSwitch', function(){
        
        setPresence( $(this).val() );

    });

    // Detecting nightmares routine
    $('body').on('input', '#nightmaresSwitch', function(){
        
        setNightmares( $(this).val() );

    });

    // Detecting party routine
    $('body').on('input', '#partySwitch', function(){
        
        setParty( $(this).val() );

    });




    

});
</script>