<div class="w3-row" style="height: 30%;">
    <div class="w3-container w3-padding-24">
        <div class="w3-card-4 w3-padding-16 w3-dark-grey">

            <h1 class="w3-center" disabled="">Groups</h1>
            <div class="w3-container w3-padding-16" id="group_list">
            </div>

            <button class="w3-button w3-round w3-black w3-margin">Add new Room</button>

        </div>
    </div>

    <div class="w3-modal" id="modal">

        <div class="w3-modal-content" style="width: 90%; height: 90%;">
            <div class="w3-container">

                <div class="w3-card-4 w3-dark-grey" style="width: 100%; height: 100%;">
                    
                    <div class="w3-container w3-center">
                        <h1><b id="roomName"></b> room</h1>
                    </div>

                    <canvas class="w3-container"></canvas>

                    <button class="w3-button w3-round w3-black w3-margin w3-padding" onclick="closeModal('modal')">Close</button>                
                </div>

            </div>
        </div>

    </div>
</div>

<!-- <canvas class="w3-container w3-padding-16" style="width: 100%; height: 100%;" id="draw"></canvas> -->

<div class="w3-row" style="height: 70%;">
    <div class="w3-container w3-circle w3-padding" style="width: 40%; height: 40%;">
        <span class="dot" style="width: 100%; height: 100%; background-color: black; border-radius: 50%; display: inline-block">HOLA</span>
    </div>
</div>

<script type="text/javascript">

    function loadModal(room){

        $('#roomName').empty();
        $('#roomName').append(room);

        sessionStorage.setItem('roomName', room);

        $.ajax({
            url: 'https://broker.dalher.net/v3/groups/lists',
            type: 'get',
            headers: {
                "Authorization" : "Bearer " + sessionStorage.access_token
            },
            beforeSend: function(){
                console.log("Obteniendo canales de grupo del Usuario...");
            },
            success: function(response){
                console.log("Obtenidos...");
                console.log(response);

                // $('#draw').empty();

                // var canvas = document.getElementById("draw");
                // var ctx = canvas.getContext("2d");

                // var x = 50;//$('#draw').height() / 2;
                // var y = 50;//$('#draw').width() / 2;

                // console.log(x);
                // console.log(y);

                // ctx.arc(x, y, 10, 0, 2*Math.PI);
                // ctx.stroke();

                // for(var i = 0 ; i < response.length ; i++){
                //     if(response[i].group == room){
                //         for(var j = 0 ; j < response[i].channels.length ; j++){
                //             var channel = response[i].channels[j].channel;
                //             var button = document.createElement("button");
                //             var node = document.createTextNode(channel);
                //             button.appendChild(node);
                //             button.className = "w3-button w3-block w3-border";

                //             var newBtn = document.getElementById("group_list_modal");
                //             newBtn.appendChild(button);
                //         }
                //     }
                // }
            },
            error: function(){
                console.log("Error");
                console.log(response);
            }
        });

        document.getElementById('modal').style.display = 'block';

    }

    function closeModal(id){

        document.getElementById(id).style.display = 'none';

    }

    function getGroupList(){

        $.ajax({
            url: 'https://broker.dalher.net/v3/groups/list',
            type: 'get',
            headers: {
                "Authorization" : "Bearer " + sessionStorage.access_token
            },
            beforeSend: function(){
                console.log("Obteniendo Grupos del Usuario...");
            },
            success: function(response){
                console.log("Obtenidos...");
                console.log(response);

                var groups = [];
                var i;
                for(i = 0 ; i < response.length ; i++){
                    var button = document.createElement("button");
                    var node = document.createTextNode(response[i].group);
                    button.appendChild(node);
                    button.className = "w3-button w3-block w3-border";
                    button.setAttribute('onclick', "loadModal('"+ response[i].group +"')");

                    var groupName = response[i].group;

                    button.setAttribute("id", response[i].group);

                    var newBtn = document.getElementById("group_list");
                    newBtn.appendChild(button);
                }
            },
            error: function(){
                console.log("Error");
                console.log(response);
            }
        });

    }

    $(function () {
        getGroupList();
    });

</script>